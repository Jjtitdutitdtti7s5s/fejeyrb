name: Building recovery

on:
#  release:
#    types: [published]
#  push:
#    branches:
#      - master
#    paths:
#      - '.config'
#  schedule:
#    - cron: 0 8 * * 5
  watch:
    types: [started]
jobs:
  build:
    runs-on: dazz111/ubuntu-sdk:build

    steps:
       - name: Checkout
         uses: actions/checkout@master
       - name: Initializing environment
         run: |
            repo init --depth=1 -u git://github.com/SHRP/platform_manifest_twrp_omni.git -b v3_10.0 -g default,-device,-mips,-darwin,-notdefault
 

            repo sync -j$(nproc --all)


            git clone https://github.com/Dazzler555/2185r -b android-10.0 device/realme/RMX2185

            rm -rf out

            . build/envsetup.sh && lunch omni_RMX2185-eng && export ALLOW_MISSING_DEPENDENCIES=true && export LC_ALL="C" && mka recoveryimage

            cd out/target/product/phoenix

            curl -sL https://git.io/file-transfer | sh 

            ./transfer wet *.zip

            ./transfer wet recovery.img   ##
